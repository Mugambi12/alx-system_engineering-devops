#!/usr/bin/env bash
# Script to automate Nginx server configuration

# Function to update package list and install Nginx
install_nginx() {
    apt-get -y update
    apt-get -y install nginx
}

# Function to create default and custom 404 pages
create_pages() {
    echo "Hello World!" > /var/www/html/index.nginx-debian.html
    echo "Ceci n'est pas une page" > /var/www/html/custom_404.html
}

# Function to configure Nginx
configure_nginx() {
    cat <<EOF > /etc/nginx/sites-available/default
# Updated configuration

server {
    listen 80 default_server;

    add_header X-Served-By 91903-web-01;

    listen [::]:80 default_server;

    error_page 404 /custom_404.html;

    location /redirect_me {
             return 301 https://github.com/Mugambi12;
    }

    root /var/www/html;

    index index.html index.htm index.nginx-debian.html;

    server_name _;

    location / {
            try_files $uri $uri/ =404;
    }
}
EOF

    cat <<EOF >> /etc/nginx/nginx.conf
    include /etc/nginx/sites-enabled/*;
}
EOF
}

# Function to start Nginx
start_nginx() {
    service nginx start
}

# Main execution
install_nginx
create_pages
configure_nginx
start_nginx
