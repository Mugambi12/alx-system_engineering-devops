#!/usr/bin/env bash
# This script is intended to fix the issue with Nginx not listening on port 80.
# It will configure Nginx to listen on port 80 of all active IPv4 IPs.

# Step 1: Check if Nginx is installed
if ! [ -x /usr/sbin/nginx ]; then
    # If Nginx is not installed, install it
    apt-get -y update
    apt-get -y install nginx
fi

# Step 2: Configure Nginx to listen on port 80
# Nginx's default configuration should be modified
# to listen on port 80 by default.

# We'll create a new configuration file for Nginx
echo "server {
    listen 80;
    server_name _;
    location / {
        root /var/www/html;
        index index.html;
    }
}" > /etc/nginx/sites-available/default

# Create a simple index.html file to serve as the web page
echo "<html><body><h1>Hello, Nginx!</h1></body></html>" > /var/www/html/index.html

# Step 3: Restart Nginx to apply the changes
service nginx restart
